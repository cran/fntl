<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrew M. Raim">

<title>fntl: Tools for Rcpp with STL Functions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="fntl_files/libs/clipboard/clipboard.min.js"></script>
<script src="fntl_files/libs/quarto-html/quarto.js"></script>
<script src="fntl_files/libs/quarto-html/popper.min.js"></script>
<script src="fntl_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="fntl_files/libs/quarto-html/anchor.min.js"></script>
<link href="fntl_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="fntl_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="fntl_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="fntl_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="fntl_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><code>fntl</code>: Tools for Rcpp with STL Functions</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Andrew M. Raim<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> <a href="mailto:andrew.raim@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Last modified: 2024-05-23 23:02</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>TBD abstract goes here.</p>
  </div>
</div>


</header>


<section id="comments" class="level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Comments</h1>
<p>I think a nice document will make a huge difference in the usability of this package. The generated documentation from Doxygen is okay, but not the most appealing. It has a lot of cruft that distracts from what I’d want to see as a user.</p>
<p>Here’s what I have in mind right now. Let’s try to manually document the API in a human readable way.</p>
<p>TBD:</p>
<ul>
<li>should <code>fd_hessian</code> use the Numerical Cookbook version of <code>fd_deriv</code>?</li>
<li>make sure to mark C++11 as a requirement for this package. We may need an attribute like <code>[[Rcpp::plugins("cpp11")]]</code> somewhere too.</li>
</ul>
</section>
<section id="intro" class="level1">
<h1>Intro</h1>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p>The idea of the package is to pass STL functions as arguments like we normally do in R, and have it feel as similar as possible. This might be a good opportunity to cite the original paper on the R language.</p>
<p>Rcpp: why/when we’re motivated to use it and write tools for it. When can R be slow and why use R versus C++?</p>
<p>What is the use case? In many situations, we carry out tasks like integration and optimization in R and write the integrand or target function in C++ if their computation is slow or cumbersome in R. Rcpp is used to generate an R interface for the C++ function so that they can be integrated. A use case for the present work is when we are in Rcpp already, perhaps as part of a larger computation, and need to do an integration. Calling back to R is possible, but incurs a performance penalty. Doing so repeatedly accumulates the penalty, and may negate performance benefits of using C++ in the first place.</p>
</div>
</div>
<section id="principles" class="level2">
<h2 class="anchored" data-anchor-id="principles">Principles</h2>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Avoid external dependencies beyond base R, the Rcpp package, and dependencies needed for these. This is to make the package usable in a locked-down environment where installing system libraries may be a nontrivial ask.</p></li>
<li><p>Where possible, we prefer to use C implementations of methods which are exposed within base R. For these, we implement adapters which allow the C implementation to call the users STL function.</p></li>
<li><p>We roll our own implementation of a method when necessary. We may opt for a more basic algorithm or a less optimized code than, say, one in Netlib. Good error handling and correctness of the code are most important.</p></li>
<li><p>We don’t implement functions where it is easy to use STL functions with the existing Rcpp interface. For example, see the demo with a lambda function <a href="RcppLambdaDemo">here</a>. We can give an example of <code>sapply</code> here and show that base Rcpp is enough there.</p></li>
</ul>
</div>
</div>
</section>
<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review">Literature review</h2>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><a href="https://cran.r-project.org/package=roptim">Roptim</a> has similar functionality to call the optim family of fucntions, but uses Functors. They have a nice guide to calling the C functions underlying <code>optim</code> which was very helpful for the present package.</p></li>
<li><p><a href="https://cran.r-project.org/package=RcppNumerical">RcppNumerical</a> also has some of the same functionality. It makes use of libraries <code>NumericalIntegration</code> and <code>LBFGS++</code> which are not specific to R. Its interface is also based on Functors.</p></li>
<li><p>We try to make the C++ interface as R-like as possible.</p></li>
<li><p>I think it would be possible to make adapters to call Roptim and RcppNumerical functions with STL functions too.</p></li>
</ul>
</div>
</div>
</section>
</section>
<section id="general-programming-guide" class="level1">
<h1>General Programming Guide</h1>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>How to use the package:</p>
<ul>
<li>The <code>depends</code> statement</li>
<li>Including <code>fntl.h</code></li>
<li>Using the <code>fntl</code> namespace</li>
<li>A minimal working example might be useful here</li>
</ul></li>
<li><p>A review of STL functions and lambdas in C++.</p></li>
<li><p>The design pattern with <code>result</code>, <code>args</code>, status codes (as enum classes), and the main function. Arguments in <code>args</code> are taken to have the same defaults as in R, where it makes sense (like when the same underlying C code is called).</p></li>
<li><p>the abstract <code>result</code> class, the <code>to_list()</code> member function, and how users will make use of them.</p></li>
<li><p>Use of <code>to_underlying</code> with the status codes, and creating status codes from underlying types.</p></li>
<li><p>The <code>ErrorAction</code> enum class and its values.</p></li>
</ul>
</div>
</div>
</section>
<section id="api" class="level1">
<h1>API</h1>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p>I think the idea will be to have one subsection per function.</p>
<p>For each subsection:</p>
<ul>
<li>Which method is being implemented?</li>
<li>Give references where possible.</li>
<li>Did we write the code ourselves, call something in R, etc?</li>
<li>The interface
<ul>
<li>The main function(s) and a table describing its arguments.</li>
<li>The arg structure: member names, types, descriptions, and default values.</li>
<li>The result structure: member names, types, and descriptions.</li>
<li>The list of status codes, if any.</li>
</ul></li>
<li>A brief example: only a snippet to illustrate usage. Doesn’t need to be the full code to compile and run. However, we might also want to show a fully working example alongside the snippet, perhaps with a link to the code.</li>
</ul>
</div>
</div>
<section id="integration" class="level2">
<h2 class="anchored" data-anchor-id="integration">Integration</h2>
<p>Source code can be found in <a href="https://github.com/andrewraim/fntl/blob/main/inst/include/integrate.h">integrate.h</a>.</p>
<section id="description" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="description">Description</h3>
<p>Compute the integral <!-- --> <span class="math display">\[
\int_a^b f(x) dx,
\]</span> <!-- --> where <span class="math inline">\(a\)</span> may be finite or <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(b\)</span> may be finite or <span class="math inline">\(\infty\)</span>. Calls one of two C functions underlying the R function <code>integrate</code>: <code>Rdqags</code> when both limits are finite and <code>Rdqagi</code> otherwise. These functions are based on routines in QUADPACK <span class="citation" data-cites="PiessensEtAl1983">(<a href="#ref-PiessensEtAl1983" role="doc-biblioref">Piessens et al. 1983</a>)</span>.</p>
</section>
<section id="function" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="function">Function</h3>
<p>The second form uses defaults for all elements of <code>args</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode cpp code-annotation-code code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a>integrate_result integrate<span class="op">(</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-1-2" class="code-annotation-target"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> uv_function<span class="op">&amp;</span> f<span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> lower<span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-1-4" class="code-annotation-target"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> upper<span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-1-5" class="code-annotation-target"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> integrate_args<span class="op">&amp;</span> args</span>
<span id="annotated-cell-1-6"><a href="#annotated-cell-1-6" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-1-8"><a href="#annotated-cell-1-8" aria-hidden="true" tabindex="-1"></a>integrate_result integrate<span class="op">(</span></span>
<span id="annotated-cell-1-9"><a href="#annotated-cell-1-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> uv_function<span class="op">&amp;</span> f<span class="op">,</span></span>
<span id="annotated-cell-1-10"><a href="#annotated-cell-1-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> lower<span class="op">,</span></span>
<span id="annotated-cell-1-11"><a href="#annotated-cell-1-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> upper</span>
<span id="annotated-cell-1-12"><a href="#annotated-cell-1-12" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="2,9" data-code-annotation="1">Function to take as the integrand.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="3,10" data-code-annotation="2">Lower limit <span class="math inline">\(a\)</span> of integral; may be <code>R_NegInf</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="4,11" data-code-annotation="3">Upper limit <span class="math inline">\(b\)</span> of integral; may be <code>R_PosInf</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="5" data-code-annotation="4">Additional arguments.</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="optional-arguments" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="optional-arguments">Optional Arguments</h3>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode cpp code-annotation-code code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-2-1"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> integrate_args <span class="op">{</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-2-2" class="code-annotation-target"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">int</span> subdivisions <span class="op">=</span> <span class="dv">100</span><span class="bu">L</span><span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-2-3" class="code-annotation-target"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> rel_tol <span class="op">=</span> mach_eps_4r<span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> abs_tol <span class="op">=</span> mach_eps_4r<span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-2-5" class="code-annotation-target"><a href="#annotated-cell-2-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> stop_on_error <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="annotated-cell-2-6"><a href="#annotated-cell-2-6" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="2" data-code-annotation="1">The maximum number of subintervals.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="3" data-code-annotation="2">Relative accuracy requested.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="3">Absolute accuracy requested.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="5" data-code-annotation="4">If <code>true</code>, errors in <code>integrate</code> raise exceptions.</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="result" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="result">Result</h3>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode cpp code-annotation-code code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> integrate_result <span class="op">:</span> <span class="kw">public</span> result <span class="op">{</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-3-2" class="code-annotation-target"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> value<span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-3-3" class="code-annotation-target"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> abs_error<span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> subdivisions<span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-3-5" class="code-annotation-target"><a href="#annotated-cell-3-5" aria-hidden="true" tabindex="-1"></a>    integrate_status status<span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="5" onclick="event.preventDefault();" href="">5</a><span id="annotated-cell-3-6" class="code-annotation-target"><a href="#annotated-cell-3-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n_eval<span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="6" onclick="event.preventDefault();" href="">6</a><span id="annotated-cell-3-7" class="code-annotation-target"><a href="#annotated-cell-3-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>string message<span class="op">;</span></span>
<span id="annotated-cell-3-8"><a href="#annotated-cell-3-8" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="7" onclick="event.preventDefault();" href="">7</a><span id="annotated-cell-3-9" class="code-annotation-target"><a href="#annotated-cell-3-9" aria-hidden="true" tabindex="-1"></a>    Rcpp<span class="op">::</span>List to_list<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="annotated-cell-3-10"><a href="#annotated-cell-3-10" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="2" data-code-annotation="1">The final approximation of the integral.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="3" data-code-annotation="2">Estimate of the modulus of the absolute error.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="3">The number of subintervals produced in the subdivision process.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="5" data-code-annotation="4">A code describing the status of the operation.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="6" data-code-annotation="5">Number of function evaluations.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="7" data-code-annotation="6">A message describing the status of the operation.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="9" data-code-annotation="7">Return an Rcpp <code>List</code> representation.</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="status-codes" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="status-codes">Status Codes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode cpp code-annotation-code code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> integrate_status <span class="op">:</span> <span class="dt">int</span> <span class="op">{</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="0" onclick="event.preventDefault();" href="">0</a><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a>    OK <span class="op">=</span> <span class="dv">0</span><span class="bu">L</span><span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-4-3" class="code-annotation-target"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>    MAX_SUBDIVISIONS <span class="op">=</span> <span class="dv">1</span><span class="bu">L</span><span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a>    ROUNDOFF_ERROR <span class="op">=</span> <span class="dv">2</span><span class="bu">L</span><span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-4-5" class="code-annotation-target"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>    BAD_INTEGRAND_BEHAVIOR <span class="op">=</span> <span class="dv">3</span><span class="bu">L</span><span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-4-6" class="code-annotation-target"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>    ROUNDOFF_ERROR_EXTRAPOLATION_TABLE <span class="op">=</span> <span class="dv">4</span><span class="bu">L</span><span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="5" onclick="event.preventDefault();" href="">5</a><span id="annotated-cell-4-7" class="code-annotation-target"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a>    PROBABLY_DIVERGENT_INTEGRAL <span class="op">=</span> <span class="dv">5</span><span class="bu">L</span><span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="6" onclick="event.preventDefault();" href="">6</a><span id="annotated-cell-4-8" class="code-annotation-target"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a>    INVALID_INPUT <span class="op">=</span> <span class="dv">6</span><span class="bu">L</span></span>
<span id="annotated-cell-4-9"><a href="#annotated-cell-4-9" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="0">0</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="0">OK.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="3" data-code-annotation="1">maximum number of subdivisions reached.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4" data-code-annotation="2">roundoff error was detected.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="5" data-code-annotation="3">extremely bad integrand behaviour.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="6" data-code-annotation="4">roundoff error is detected in the extrapolation table.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="7" data-code-annotation="5">the integral is probably divergent.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="8" data-code-annotation="6">the input is invalid.</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="example" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="example">Example</h3>
<p>Compute the integral <span class="math inline">\(\int_{-\infty}^0 e^{-x^2/2} dx\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> fntl<span class="op">::</span>uv_function<span class="op">&amp;</span> f <span class="op">=</span> <span class="op">[](</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> exp<span class="op">(-</span>pow<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> out <span class="op">=</span> fntl<span class="op">::</span>integrate<span class="op">(</span>f<span class="op">,</span> R_NegInf<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> value <span class="op">=</span> out<span class="op">.</span>value<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="finite-differences" class="level2">
<h2 class="anchored" data-anchor-id="finite-differences">Finite Differences</h2>
<section id="derivative" class="level3">
<h3 class="anchored" data-anchor-id="derivative">Derivative</h3>
<p>Source code can be found in <a href="https://github.com/andrewraim/fntl/blob/main/inst/include/fd-deriv.h">fd-deriv.h</a>.</p>
<section id="description-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="description-1">Description</h4>
<p>Compute the derivative of <span class="math inline">\(f : \mathbb{R} \rightarrow \mathbb{R}\)</span> numerically at point <span class="math inline">\(x\)</span> using Ridders algorithm, adapted from the program <code>dfridr</code> in Section 5.7 of <span class="citation" data-cites="PressEtAl2007">Press et al. (<a href="#ref-PressEtAl2007" role="doc-biblioref">2007</a>)</span>.</p>
</section>
<section id="function-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="function-1">Function</h4>
<p>The second form uses defaults for all elements of <code>args</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode cpp code-annotation-code code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a>fd_deriv_result fd_deriv<span class="op">(</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-6-2" class="code-annotation-target"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> uv_function<span class="op">&amp;</span> f<span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-6-3" class="code-annotation-target"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> x<span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-6-4" class="code-annotation-target"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> h <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-6-5" class="code-annotation-target"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">int</span> maxiter <span class="op">=</span> <span class="dv">10</span></span>
<span id="annotated-cell-6-6"><a href="#annotated-cell-6-6" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="2" data-code-annotation="1">Function to differentiate.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="3" data-code-annotation="2">Point where derivative is taken.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="4" data-code-annotation="3">Initial step size.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="5" data-code-annotation="4">Maximum number of iterations.</span>
</dd>
</dl>
</div>
</div>
<p>TBD is this true? Taking <code>maxiter = 1</code> gives the basic (symmetric) finite-difference derivative using the initial value of <code>h</code> as the perturbation.</p>
</section>
<section id="result-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="result-1">Result</h4>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode cpp code-annotation-code code-with-copy code-annotated"><code class="sourceCode cpp"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> fd_deriv_result <span class="op">:</span> <span class="kw">public</span> result <span class="op">{</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1" onclick="event.preventDefault();" href="">1</a><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> value<span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2" onclick="event.preventDefault();" href="">2</a><span id="annotated-cell-7-3" class="code-annotation-target"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> err<span class="op">;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3" onclick="event.preventDefault();" href="">3</a><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">int</span> iter<span class="op">;</span></span>
<span id="annotated-cell-7-5"><a href="#annotated-cell-7-5" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="4" onclick="event.preventDefault();" href="">4</a><span id="annotated-cell-7-6" class="code-annotation-target"><a href="#annotated-cell-7-6" aria-hidden="true" tabindex="-1"></a>    Rcpp<span class="op">::</span>List to_list<span class="op">()</span> <span class="at">const</span><span class="op">;</span></span>
<span id="annotated-cell-7-7"><a href="#annotated-cell-7-7" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="1">The final approximation of the derivative.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="3" data-code-annotation="2">An estimate of the error in approximation.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="3">Number of iterations used to produce approximation.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="6" data-code-annotation="4">Return an Rcpp <code>List</code> representation.</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="example-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="example-1">Example</h4>
<p>Compute the derivative of <span class="math inline">\(f(x) = \sin(x)\)</span> at <span class="math inline">\(x = 1/2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> fntl<span class="op">::</span>uv_function<span class="op">&amp;</span> f <span class="op">=</span> <span class="op">[](</span><span class="dt">double</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sin<span class="op">(</span>x<span class="op">);</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">auto</span> out <span class="op">=</span> fntl<span class="op">::</span>fd_deriv<span class="op">(</span>f<span class="op">,</span> <span class="fl">0.5</span><span class="op">);</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="dt">double</span> value <span class="op">=</span> out<span class="op">.</span>value<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="gradient" class="level3">
<h3 class="anchored" data-anchor-id="gradient">Gradient</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>fd-grad.h</code></p>
</div>
</div>
</section>
<section id="hessian" class="level3">
<h3 class="anchored" data-anchor-id="hessian">Hessian</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>fd-hessian.h</code></p>
</div>
</div>
</section>
<section id="jacobian" class="level3">
<h3 class="anchored" data-anchor-id="jacobian">Jacobian</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>fd-jacobian.h</code></p>
</div>
</div>
</section>
</section>
<section id="root-finding" class="level2">
<h2 class="anchored" data-anchor-id="root-finding">Root-Finding</h2>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>findroot.h</code></p>
</div>
</div>
</section>
<section id="optimization" class="level2">
<h2 class="anchored" data-anchor-id="optimization">Optimization</h2>
<section id="golden-section-search" class="level3">
<h3 class="anchored" data-anchor-id="golden-section-search">Golden Section Search</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>goldensection.h</code></p>
</div>
</div>
</section>
<section id="brents-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="brents-algorithm">Brent’s Algorithm</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>brent...</code></p>
</div>
</div>
</section>
<section id="nelder-mead" class="level3">
<h3 class="anchored" data-anchor-id="nelder-mead">Nelder-Mead</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>neldermead.h</code></p>
</div>
</div>
</section>
<section id="bfgs" class="level3">
<h3 class="anchored" data-anchor-id="bfgs">BFGS</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>bfgs...</code></p>
</div>
</div>
</section>
<section id="l-bfgs-b" class="level3">
<h3 class="anchored" data-anchor-id="l-bfgs-b">L-BFGS-B</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>lbfgsb.h</code></p>
</div>
</div>
</section>
<section id="conjugate-gradient" class="level3">
<h3 class="anchored" data-anchor-id="conjugate-gradient">Conjugate Gradient</h3>
<p><code>cgmin...</code></p>
</section>
<section id="simulated-annealing" class="level3">
<h3 class="anchored" data-anchor-id="simulated-annealing">Simulated Annealing</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>samin...</code></p>
</div>
</div>
</section>
<section id="newton-raphson" class="level3">
<h3 class="anchored" data-anchor-id="newton-raphson">Newton-Raphson</h3>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>nlm...</code></p>
</div>
</div>
</section>
</section>
</section>
<section id="examples" class="level1">
<h1>Examples</h1>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p>Not sure what to put here… maybe we can give some more involved but still small examples, and show the results? We could potentially merge this with the performance studies section if the examples here are used there.</p>
</div>
</div>
</section>
<section id="performance-studies" class="level1">
<h1>Performance Studies</h1>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ideas</p>
<ul>
<li><p>Pick an application(s) with some intensive optimization or integration, but which is simple enough to describe briefly.</p></li>
<li><p>Compare the following implementations</p>
<ul>
<li>Pure R</li>
<li>A matrix-ized version</li>
<li>A version in Rcpp where we call back to R for the optimization or integration</li>
<li>A version in Rcpp where we use this package.</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p>Content needed</p>
</div>
</div>
</section>
<section id="acknowledgments" class="level1 unnumbered">
<h1 class="unnumbered">Acknowledgments</h1>
<div class="callout callout-style-default callout-caution no-icon callout-titled" title="TBD">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TBD
</div>
</div>
<div class="callout-body-container callout-body">
<p>Content needed</p>
</div>
</div>
</section>
<section id="references" class="level1 unnumbered">


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-PiessensEtAl1983" class="csl-entry" role="listitem">
Piessens, R., E. deDoncker-Kapenga, C. W. Uberhuber, and D. K. Kahaner. 1983. <em><span>QUADPACK</span>: A Subroutine Package for Automatic Integration</em>. Springer.
</div>
<div id="ref-PressEtAl2007" class="csl-entry" role="listitem">
Press, William H., Saul A. Teukolsky, William T. Vetterling, and Brian P. Flannery. 2007. <em>Numerical Recipes: The Art of Scientific Computing</em>. 3rd ed. Cambridge University Press.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Corresponding author <a href="mailto:andrew.raim@gmail.com" class="email">andrew.raim@gmail.com</a>. Center for Statistical Research &amp; Methodology, U.S. Census Bureau, Washington, DC, 20233, U.S.A. <strong>Disclaimer</strong><code>:</code> This document is released to inform interested parties of ongoing research and to encourage discussion of work in progress. Any views expressed are those of the authors and not those of the U.S. Census Bureau.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Corresponding author <a href="mailto:andrew.raim@gmail.com" class="email">andrew.raim@gmail.com</a>. Center for Statistical Research &amp; Methodology, U.S. Census Bureau, Washington, DC, 20233, U.S.A. <strong>Disclaimer</strong><code>:</code> This document is released to inform interested parties of ongoing research and to encourage discussion of work in progress. Any views expressed are those of the authors and not those of the U.S. Census Bureau.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Corresponding author <a href="mailto:andrew.raim@gmail.com" class="email">andrew.raim@gmail.com</a>. Center for Statistical Research &amp; Methodology, U.S. Census Bureau, Washington, DC, 20233, U.S.A. <strong>Disclaimer</strong><code>:</code> This document is released to inform interested parties of ongoing research and to encourage discussion of work in progress. Any views expressed are those of the authors and not those of the U.S. Census Bureau.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>